# Персональные рекомендации для пользователей
## Постановка задачи

Интернет-магазин «В один клик» столкнулся с проблемой снижения активности постоянных покупателей. Привлечение новых клиентов стало менее эффективным, поэтому компания решила сосредоточиться на удержании текущих клиентов путем создания персонализированных предложений. Задача состояла в разработке модели, которая предскажет вероятность снижения покупательской активности клиентов в ближайшие три месяца, а также в сегментации покупателей для разработки целевых предложений.
Исходные данные

## Для выполнения задачи использовались данные из нескольких таблиц:

    market_file.csv: данные о поведении на сайте, коммуникациях и продуктовом поведении покупателей.
    market_money.csv: данные о выручке с покупателей за разные периоды.
    market_time.csv: данные о времени, проведенном на сайте покупателями.
    money.csv: данные о средней прибыли с каждого покупателя за последние три месяца.

## Предобработка данных

    Загрузка и проверка данных на соответствие описанию.
    Очистка данных от пропусков и аномалий.
    Приведение данных к единому формату (например, разделение данных о выручке и времени на сайте по периодам в отдельные столбцы).
    Объединение таблиц в одну итоговую таблицу для дальнейшего анализа и моделирования.

## Исследовательский анализ данных

    Анализ распределения целевого признака («снизилась» или «прежний уровень» активности).
    Исследование распределения количественных и категориальных признаков.
    Отбор клиентов с активностью не менее трех месяцев для анализа.

## Корреляционный анализ

    Вычисление корреляции между количественными признаками.
    Выявление мультиколлинеарности и устранение высококоррелированных признаков, если необходимо.

## Построение моделей

Для предсказания вероятности снижения покупательской активности были использованы следующие модели:

    KNeighborsClassifier
    DecisionTreeClassifier
    LogisticRegression
    SVC (Support Vector Classifier)

В процессе подготовки данных для моделей использовались пайплайны с применением различных методов масштабирования количественных признаков и кодирования категориальных признаков (например, OneHotEncoder и OrdinalEncoder).
Выбор лучшей модели

Для каждой модели были настроены гиперпараметры с использованием подходящих стратегий и метрик (например, accuracy, F1-score, ROC-AUC). В итоге была выбрана модель с наилучшей производительностью по выбранной метрике.
Анализ важности признаков

С использованием метода SHAP были оценены значимости признаков для лучшей модели. Это позволило понять, какие признаки наиболее сильно влияют на целевой признак и какие из них менее значимы.
Сегментация покупателей

Были выделены различные сегменты покупателей на основе результатов моделирования и данных о прибыльности:

    Группа клиентов с максимальной долей покупок по акции и высокой вероятностью снижения покупательской активности.
    Группа клиентов, покупающих только технику.
    Группа клиентов, покупающих товары из категории «Товары для детей».
    Группа клиентов с высокой вероятностью снижения активности и наиболее высокой прибыльностью.

Для каждого сегмента были предложены рекомендации по увеличению покупательской активности, такие как специальные акции, персонализированные предложения и улучшение качества обслуживания.

## Выводы

Проект продемонстрировал важность использования данных и моделей машинного обучения для решения бизнес-задач. Лучшая модель успешно предсказывает снижение активности клиентов, а сегментация позволяет разрабатывать целевые маркетинговые стратегии для удержания клиентов и увеличения их покупательской активности.
